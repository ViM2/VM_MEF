\chapter{Formulation pratique d'éléments finis}\label{Ch-Elts}
\begin{abstract}
L'intégralité de la méthode des éléments finis a été présentée au chapitre~\ref{Ch-MEF}.

Dans ce chapitre et dans les suivants, nous allons détailler certains aspects.
Nous proposons dans ce chapitre d'exposer un peu plus complètement les notions
d'interpolation sur un élément, ainsi que le lien entre approximation locale
(sur un élément) et approximation globale (construction de la base de~$V_h$).
\end{abstract}


Nous avons dit vouloir interpoler le problème sur chaque élément.
Pour ce faire, il faut prendre une \textcolorblue{base} sur chaque élément.
Plusieurs choix sont possibles, mais en général, les fonctions de base utilisées pour les
éléments finis sont dites \textcolorblue{interpolantes}, c'est-à-dire que les
\textcolorblue{valeurs nodales} sont les valeurs des grandeurs inconnues aux nœuds,
et que c'est à partir de ces valeurs que l'on effectue l'interpolation.

\medskip
La méthode la plus simple consiste à utiliser les polynômes de Lagrange.\index[aut]{Lagrange (Joseph Louis, comte de -), 1736-1813, Italien}
Dans cette méthode les fonctions de base valent 1 à un nœud du maillage et 0 à tous les autres.
La fonction de base~$i$ est alors la fonction valant 1 au nœud~$i$ et 0 sur les autres nœuds
et qui est polynomiale sur chaque élément.
Il y a autant de fonctions de base par élément que de nombre de nœuds.
On appelle \textcolorblue{élément} la donnée d'une \textcolorblue{géométrie}
(souvent polygonale en deux dimensions, polyédrique en trois dimensions) et de \textcolorblue{fonctions de base associées
à cette géométrie}.

\medskip
D'autres solutions peuvent exister pour les fonctions de base.
Par exemple, les éléments finis d'Hermite\index[aut]{Hermite (Charles), 1822-1901, Français}
ont la particularité d'avoir deux fonctions de base associées à chaque nœud.
La valeur de la solution est alors ajustée avec la première fonction alors que la deuxième
permet d'ajuster la valeur de la dérivée.
Ce type de fonctions de base peut avoir un intérêt pour la résolution de certaines EDP
(telle que l'équation des plaques en Mécanique des Milieux Continus), même si elle nécessite d'avoir deux fois plus
de fonctions pour un maillage donné.








\medskip
\section{Éléments de Lagrange}\index{élément fini!de Lagrange}\index[aut]{Lagrange (Joseph Louis, comte de -), 1736-1813, Italien}

Les éléments de Lagrange sont les éléments finis les plus simples.

\medskip
\subsection{Unisolvance}\index{unisolvance}\label{Sec-unisolvance}

\begin{definition}[Unisolvance]
Soit~$\Sigma=\{a_1,\ldots, a_N\}$ un ensemble de~$N$ points distincts de~$\RR^n$.
Soit~$P$ un espace vectoriel de dimension finie de fonctions de~$\RR^n$ à valeurs dans~$\RR$.
On dit que~$\Sigma$ est \textcolorblue{$P$-unisolvant} ssi pour tous réels~$\alpha_1$,\ldots, $\alpha_N$,
il existe un unique élément~$p$ de~$P$ tel que~$\forall i=1,\ldots, N$, $p(a_i) = \alpha_i$.
(ce qui revient à dire que la fonction de~$P$ dans~$\RR^N$ qui à~$p$ fait correspondre
$(p(a_i),\ldots, p(a_N))=(\alpha_1,\ldots, \alpha_N)$ est bijective).
\end{definition}

\medskip
\subsection{Éléments finis de Lagrange}\index{élément fini!de Lagrange}

\begin{definition}[Éléments finis de Lagrange]
Un \textcolorblue{élément fini de Lagrange} est un triplet~$(K, \Sigma, P)$ tel que:
\begin{itemize}
\item~$K$ est un élément géométrique de~$\RR^n$, compact, connexe, et d'intérieur
	non vide;
\item~$\Sigma=\{a_1,\ldots, a_N\}$ un ensemble de~$N$ points distincts de~$\RR^n$;
\item~$P$ est un espace vectoriel de dimension finie de fonctions réelles définies sur~$K$, et tel
	que~$\Sigma$ soit~$P$-unisolvant (donc~$\dim P = N$).
\end{itemize}
\end{definition}
\medskip
Les \textcolorblue{fonctions de bases locales} de l'élément fini de Lagrange~$(K, \Sigma, P)$
sont les~$N$ fonctions de~$P$ telles que~$p_i(a_j)=\delta_{ij}$ pour~$1\le i,j\le N$.
\medskip
\paragraph{Remarque}~$(p_1,\ldots, p_N)$ est une base de~$P$.
\medskip
\begin{definition}[Opérateur de~$P$-interpolation]
Un \textcolorblue{opérateur de~$P$-interpolation sur~$\Sigma$} est un opérateur~$\pi_K$
qui à toute fonction~$v$ définie sur~$K$ associe la fonction~$\pi_Kv$ de~$P$ définie par:
$\pi_Kv=\dsum_{i=1}^N v(a_i)p_i$.
\end{definition}
\begin{theoreme}
$\pi_kv$ est l'unique élément de~$P$ qui prend les mêmes valeurs que~$v$ sur les
points de~$\Sigma$.
\end{theoreme}
\medskip
On notera \textcolorblue{$P_k$ l'espace vectoriel des polynômes de degré total inférieur ou égal à~$k$.}
\begin{itemize}
\item sur~$\RR$, $P_k=\vectt\{1, X,\ldots, X^k\}$ et~$\dim P_k=k+1$;
\item sur~$\RR^2$, $P_k=\vectt\{X^iY^j, 0\le i+j\le k\}$ et~$\dim P_k=\frac{(k+1)(k+2)}2$;
\item sur~$\RR^3$, $P_k=\vectt\{X^iY^jZ^l, 0\le i+j+l\le k\}$ et~$\dim P_k=\frac{(k+1)(k+2)(k+3)}6$.
\end{itemize}
\medskip
On notera \textcolorblue{$Q_k$ l'espace vectoriel des polynômes de degré inférieur ou égal à~$k$ par rapport
à chaque variable.}
\begin{itemize}
\item sur~$\RR$, $Q_k=P_k$;
\item sur~$\RR^2$, $Q_k=\vectt\{X^iY^j, 0\le i,j\le k\}$ et~$\dim Q_k=(k+1)^2$;
\item sur~$\RR^3$, $Q_k=\vectt\{X^iY^jZ^l, 0\le i,j,l\le k\}$ et~$\dim Q_k=(k+1)^3$.
\end{itemize}



\medskip
\subsection*{Éléments finis unidimensionnels}
On discrétise le segment~$\intff{a}{b}$ avec des polynômes de degrés~$1$ à~$m$.
On obtient les éléments du tableau~\ref{tab:Elem:uni}.
\begin{table}[ht]\centering\small
\begin{tabular}{c|cccc}
Élément &~$P_1$ &~$P_2$ & ... &~$P_m$\\
\hline
$K$	  &~$\intff{a}{b}$ &~$\intff{a}{b}$ & ... &~$\intff{a}{b}$\\
$\Sigma$ &~$\{a,b\}$ &~$\{a,\frac{a+b}2, b\}$& ... &$\{a+i\frac{b-a}m, i=0,\ldots, m\}$\\
$P$   &~$P_1$ &~$P_2$ & ... &~$P_m$\\
\hline
\end{tabular}
\caption{Éléments de Lagrange unidimensionnels de degrés 1 à~$m$}\label{tab:Elem:uni}
\end{table}

\medskip
\subsection*{Éléments finis bidimensionnels triangulaires}
On discrétise le triangle de sommets~$\{a_1, a_2, a_3\}$ avec, le long de chaque
arête une interpolation polynomiale de degré~$1$ à~$m$.
On obtient les éléments du tableau~\ref{tab:Elem:bi}.
\begin{table}[ht]\centering\small
\begin{tabular}{c|cc}
Élément &~$P_1$ &~$P_2$ \\
\hline
$K$	  & triangle de sommets~$\{a_1, a_2, a_3\}$ & triangle de sommets~$\{a_1, a_2, a_3\}$\\
$\Sigma$ &~$\{a_1, a_2, a_3\}$ &~$\{a_{ij}=\frac{a_i+a_j}2, 1\le i,j\le 3\}$ \\
$P$   &~$P_1$ &~$P_2$ \\
\hline
\end{tabular}
\caption{Éléments de Lagrange bidimensionnels triangulaires de degrés 1 et 2}\label{tab:Elem:bi}
\end{table}

\paragraph{Remarque}Les fonctions de base pour l'élément~$P_1$ sont définies par~$p_i(a_j) = \delta_{ij}$. Ce sont les coordonnées barycentriques:~$p_i = \lambda_i$.

\medskip
\subsection*{Éléments finis bidimensionnels rectangulaires}
On discrétise le rectangle de sommets~$\{a_1, a_2, a_3, a_4\}$ de côtés
parallèles aux axes. La formulation est décrite dans le tableau~\ref{tab:Elem:bibi}.
\begin{table}[ht]\centering\small
\begin{tabular}{c|c}
Élément &~$Q_1$\\
\hline
$K$ & rectangle de sommets~$\{a_1, a_2, a_3, a_4\}$ de côtés parallèles aux axes.\\
$\Sigma$ &~$\{a_1, a_2, a_3, a_4\}$\\
$P$ &~$Q_1$\\
\hline
\end{tabular}
\caption{Élément de Lagrange bidimensionnel rectangulaire de degré 1}\label{tab:Elem:bibi}
\end{table}

\begin{figure}[ht]
\centering
\includegraphics[height=30mm]{Lagrange2D.eps}
\caption{\label{Lagrange2D} Éléments finis de Lagrange 2D: triangulaire~$P_1$, triangulaire~$P_2$ et rectangulaire~$Q_1$}
\end{figure}

\medskip
\subsection*{Éléments finis tridimensionnels}

On distingue les éléments finis tridimensionnels suivants, qui seront illustrés à la figure~\ref{Lagrange3D}:
\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{Lagrange3D.eps}
\caption{Éléments finis de Lagrange tridimensionnels: tétraédriques~$P_1$ et~$P_2$, parallélépipédique~$Q_1$ et prismatique}\label{Lagrange3D}
\end{figure}
\begin{itemize}
\item les éléments tétraédriques, définis dans le tableau~\ref{tab:Elem:tri};
\begin{table}[ht]\centering\small
\begin{tabular}{c|cc}
Élément &~$P_1$ &~$P_2$ \\
\hline
$K$	  & tétraèdre de sommets~$\{a_1, a_2, a_3, a_4\}$ & tétraèdre de sommets~$\{a_1, a_2, a_3, a_4\}$\\
$\Sigma$ &~$\{a_1, a_2, a_3, a_4\}$ &~$\{a_i\}_{1\le i\le4}\cup\{a_{ij}\}_{1\le i<j\le 4}$ \\
$P$   &~$P_1$ &~$P_2$ \\
\hline
\end{tabular}
\caption{Éléments de Lagrange tridimensionnels tétrahédriques de degrés 1 et 2}\label{tab:Elem:tri}
\end{table}
\item les élément parallélépipédique, définis au tableau~\ref{tab:Elem:para};
\begin{table}[ht]\centering\small
\begin{tabular}{c|c}
Élément &~$Q_1$\\
\hline
$K$ & parallélépipède de sommets~$\{a_1,\ldots, a_8\}$ de côtés parallèles aux axes.\\
$\Sigma$ &~$\{a_i\}_{1\le i\le8}$\\
$P$ &~$Q_1$\\
\hline
\end{tabular}
\caption{Élément de Lagrange tridimensionnel parallélépipédique de degré 1}\label{tab:Elem:para}
\end{table}
\item et les élément prismatique, définis selon le tableau~\ref{tab:Elem:pri}.
\begin{table}[ht]\centering\small
\begin{tabular}{c|c}
Élément &~$Q_1$\\
\hline
$K$ & prisme droit de sommets~$\{a_1,\ldots, a_6\}$\\
$\Sigma$ &~$\{a_i\}_{1\le i\le6}$\\
$P$ &~$\{p(X,Y,Z) = (a + bX + cY ) + Z(d + eX + fY ), a,b,c,d,e,f\in\RR\}$\\
\hline
\end{tabular}
\caption{Élément de Lagrange tridimensionnel prismatique}\label{tab:Elem:pri}
\end{table}
\end{itemize}


\medskip
\subsection{Famille affine d'éléments finis et élément de référence}\index{élément fini!de référence}\index{élément fini!famille affine d'}
En fait, la notion de transformation affine entre un élément~$K$ d'un maillage
$\mathcal{T}_h$ et un élément de référence a déjà été utilisée en
calcul de majoration d'erreur, mais la transformation elle-même n'a pas été
détaillée.

\medskip\colorgris
Deux éléments finis~$(\hat{K}, \hat{\Sigma}, \hat{P})$ et~$(K, \Sigma, P)$ sont
affine-équivalents ssi il existe une fonction affine~$F$ inversible telle que
$K=F(\hat{K})$, $a_i=F(\hat{a_i})$, i=1,\ldots, N, et~$P=\{\hat{p}\circ F^{-1}, \hat{p}\in\hat{P}\}$.
\colorblack\normalsize

\medskip
\begin{definition}[Famille affine d'éléments finis]
On appelle \textcolorblue{famille affine d'éléments finis} une famille d'éléments finis
tous affine-équivalents à un même élément fini appelé \textcolorblue{élément
de référence}.
\end{definition}
\medskip
\textcolorgreen{D'un point de vue pratique, le fait de travailler avec une famille affine d'éléments finis permet
de ramener tous les calculs d'intégrales à des calculs sur l'élément de référence.}
Voir figure~\ref{trsfaffine} pour une illustration d'une transformation affine.
\begin{figure}[ht]
\centering
\includegraphics[height=45mm]{trsfaffine.eps}
\caption{\label{trsfaffine} Transformation affine sur un triangle}
\end{figure}
\medskip
Les éléments finis de références sont ceux obtenus, dans les cas présentés ci-dessus avec:
\begin{itemize}
\item le segment~$\intff{0}{1}$ en une dimension;
\item le triangle unité de sommets~$(0,0)$, $(0,1)$, $(1,0)$,
\item et le carré unité~$\intff{0}{1}\times\intff{0}{1}$ en deux dimensions;
\item le tétraèdre unité de sommets~$(0,0,0)$, $(1,0,0)$, $(0,1,0)$, $(0,0,1)$,
\item le cube unité~$\intff{0}{1}\times\intff{0}{1}\times\intff{0}{1}$,
\item le prisme unité de sommets~$(0,0,0)$, $(0,1,0)$, $(1,0,0)$, $(0,0,1)$, $(0,1,1)$, $(1,0,1)$.
\end{itemize}

\medskip
\subsection{Construction de la base globale}
Revenons à notre problème décrit par une équation aux dérivées partielles sous forme faible dans un domaine
$\Omega$ sur lequel on réalise un maillage~$\mathcal{T}_h$ à partir d'une famille affine
de~$N_e$ éléments finis~$(K_i, \Sigma_i, P_i)_{i=1,\ldots,N_e}$.
\medskip
Par unisolvance, la solution approchée~$u_h$ sera entièrement définie sur chaque élément fini
par ses valeurs sur les points de~$\Sigma_i$, nommés \textcolorblue{nœuds} du maillage.
Notons~$(a_1,\ldots, a_{N_h})$ les nœuds du maillage ($N_h<N_e \cdot \card\Sigma_i$).
Le problème approché revient à déterminer les valeurs de~$u_h$ aux points~$a_i$:
ce sont les \textcolorblue{degrés de liberté} du problème approché.
\medskip
On va construire une base de~$V_h$ en associant à chaque ddl~$a_i$ un vecteur de la base.
On définit ainsi les fonctions de base globales~$\varphi_i$~$(i = 1,\ldots, N_h)$ par:
\begin{equation}\varphi_i|_{K_j} \in P_j, j = 1,\ldots, N_e \quad \text{ et }\quad \varphi_i(a_j) = \delta_{ij}, 1\le i,j\le N_h\end{equation}
et l'espace d'approximation interne est~$V_h=\vectt\{\varphi_1,\ldots, \varphi_{N_h}\}$.
On remarquera qu'une telle fonction~$\varphi_i$ est nulle partout sauf sur les éléments
dont~$a_i$ est un nœud.
\begin{figure}[ht]
\centering
\includegraphics[height=40mm]{phi1}~\includegraphics[height=40mm]{phi2.eps}
\caption{\label{BaseVh} Base de~$V_h$: exemple de fonction de base globale~$\varphi_i$ sur un maillage avec des éléments triangulaires~$P_1$.}
\end{figure}

\medskip
De plus, sur un élément~$K$ dont~$a_i$ est un nœud, $\varphi_i$ vaut~$1$ en~$a_i$ et
$0$ aux autres nœuds de~$K$. Donc~$\varphi_i|_K$ est une fonction de base locale de~$K$.
On voit donc que la fonction de base globale~$\varphi_i$ est construite comme réunion des
fonctions de base locales sur les éléments du maillage dont~$a_i$ est un nœud.

\medskip
\paragraph{Remarque} ce qui précède est vrai dans le cas d'un maillage conforme, i.e si
l'intersection entre deux éléments est soit vide, soit réduite à un
sommet ou une arête en dimension 2, ou à un sommet, une arête ou une face
en dimension 3.
\begin{figure}[ht]
\centering
\includegraphics[height=25mm]{MaillageNC.eps}
\caption{Maillage non conforme: situations interdites}\label{maillageNC}
\end{figure}

\medskip
\section{Éléments d'Hermite}\index{élément fini!d'Hermite}\index[aut]{Hermite (Charles), 1822-1901, Français}

\medskip
\subsection{Classe d'un élément fini}\index[aut]{Hermite (Charles), 1822-1901, Français}

Une question naturelle est de savoir quelle est la régularité de la solution approchée
$u_h$. En particulier, $u_h$ est-elle continue? dérivable?

$u_h$ est obtenue par combinaison linéaire des fonctions de base globales
$\varphi$, la question revient donc à déterminer la régularité de celles-ci.
Par construction, on voit que la régularité de~$\varphi_i$ sera donnée par sa
régularité au niveau des interfaces entre les éléments adjacents formant
son support.

Dans les éléments finis de Lagrange, $\varphi_i$ est construite pour être continue
d'un élément à l'autre, mais pas sa dérivée... c'est cette contrainte que
nous allons introduire maintenant.


\medskip
\subsection{Éléments finis d'Hermite}\index{élément fini!d'Hermite}\index[aut]{Hermite (Charles), 1822-1901, Français}

\begin{definition}[Élément fini d'Hermite]
Un \textcolorblue{élément fini d'Hermite ou élément fini général} est un
triplet~$(K, \Sigma, P)$ tel que:
\begin{itemize}
\item~$K$ est un élément géométrique de~$\RR^n$, compact, connexe, et d'intérieur
	non vide;
\item~$\Sigma=\{\sigma_1,\ldots, \sigma_N\}$ un ensemble de~$N$ \textcolorred{formes linéaires}
	sur l'espace des fonctions définies sur~$K$, ou sur un sous-espace plus régulier contenant~$P$;
\item~$P$ est un espace vectoriel de dimension finie de fonctions réelles définies sur~$K$, et tel
	que~$\Sigma$ soit~$P$-unisolvant.
\end{itemize}
\end{definition}

\medskip
\begin{definition}[Opérateur de~$P$-interpolation]
Un \textcolorblue{opérateur de~$P$-interpolation sur~$\Sigma$} est un opérateur~$\pi_K$
qui à toute fonction~$v$ définie sur~$K$ associe la fonction~$\pi_Kv$ de~$P$ définie par:
$\colorred\pi_Kv=\dsum_{i=1}^N \sigma_i(v)p_i$.
\end{definition}
\medskip
$\pi_kv$ est l'unique élément de~$P$ qui prend les mêmes valeurs que~$v$ sur les
points de~$\Sigma$.
\medskip
On remarque immédiatement que si~$\sigma_i(p) = p(ai), i=1,\ldots, N$, on retrouve les éléments finis
de Lagrange.\index[aut]{Lagrange (Joseph Louis, comte de -), 1736-1813, Italien}\index{élément fini!de Lagrange}
Cette généralisation permet d'introduire des opérations de dérivation dans~$\Sigma$,
et donc d'améliorer la régularité des fonctions de~$V_h$.
\medskip
Les \textcolorblue{fonctions de base globales}~$\varphi_i$, $(i=1,\ldots, N_h)$ sont
définies par:
\begin{equation}
\varphi_i|_{K_j} \in P_j, j=1,\ldots, N_e \quad \text{ et } \quad \colorred
\sigma_j(\varphi_i)=\delta_{ij}, 1\le i,j\le N_h
\end{equation}

Suivant les éléments utilisés, ces fonctions de base pourront être de classe~$C^1$
ou même plus, et il en sera donc de même pour la solution approchée~$u_h$.


\medskip
\subsection{Éléments uni- et bidimensionnels}
%\subsection*{Éléments finis unidimensionnels}

Nous présentons quelques éléments finis d'Hermite utilisés classiquement, dont certains seront illustrés
à la figure~\ref{Hermite2D}:
\begin{figure}[ht]
\centering
\includegraphics[width=\textwidth]{Hermite2D.eps}
\caption{Éléments finis d'Hermite triangulaire cubique, élément d'Argyris et élément rectangulaire~$Q_3$}\label{Hermite2D}
\end{figure}
\begin{itemize}
\item les \textcolorblue{éléments finis unidimensionnels cubiques et quintiques} sont définis au tableau~\ref{tab:ElemH:uni};
\begin{table}[ht]\centering\small
\begin{tabular}{c|cc}
Élément & cubique & quintique\\
\hline
$K$	  & segment~$\intff{a}{b}$ & segment~$\intff{a}{b}$\\
$\Sigma$ &~$\{p(a), p'(a), p(b), p'(b)\}$ &~$\{p(a), p'(a), p''(a), p(b), p'(b), p''(b)\}$\\
$P$   &~$P_3$ &~$P_3$\\
Régularité &~$C^1$ et~$H^2$ &~$C^2$ et~$H^3$\\
\hline
\end{tabular}
\caption{Éléments d'Hermite unidimensionnels de degrés 3 et 5}\label{tab:ElemH:uni}
\end{table}
\item les \textcolorblue{éléments finis bidimensionnels triangulaires}:
	on distingue l'élément \textcolorblue{cubique d'Hermite}, qui est~$C^0$, et
  l'éléments \textcolorblue{d'Argyris}, qui est~$C^1$.
	Ils sont présentés dans les tableaux~\ref{tab:ElemH:bi} et~\ref{tab:ElemA:bi};
\begin{table}[ht]\centering\small
\begin{tabular}{c|c}
Élément &\\
\hline
$K$	  & triangle de sommets~$\{a_1, a_2, a_3\}$\\
$\Sigma$ &~$\left\{p(a_i), \frac{\partial p}{\partial x}(a_i), i=1, 2, 3\right\} \cup\left\{p(a_0)\right\}$\\
$P$   &~$P_3$\\
Régularité &~$C^0$, mais pas~$C^1$\\
\hline
\end{tabular}\caption{Élément bidimensionnel triangulaire d'Hermite}\label{tab:ElemH:bi}
\end{table}
\begin{table}\centering\small
\begin{tabular}{c|cc}
Élément & \\
\hline
$K$	  & triangle de sommets~$\{a_1, a_2, a_3\}$ \\
$\Sigma$ &~$\left\{p(a_i), \frac{\partial p}{\partial x}(a_i), \frac{\partial p}{\partial y}(a_i),
		\frac{\partial^2 p}{\partial x^2}(a_i), \frac{\partial^2 p}{\partial y^2}(a_i),
		\frac{\partial^2 p}{\partial x\partial y}(a_i), i=1, 2, 3\right\}
		\cup\left\{\frac{\partial p}{\partial n}(a_{ij}), 1\le i<j\le3\right\}$\\
$P$   &~$P_5$\\
Régularité &~$C^1$\\
\hline
\end{tabular}
\caption{Élément bidimensionnel triangulaire d'Argyris}\label{tab:ElemA:bi}
\end{table}
\item l'\textcolorblue{élément fini bidimensionnel rectangulaire} défini au tableau~\ref{tab:ElemH:bibi};

\begin{table}[ht]\centering\small
\begin{tabular}{c|c}
Élément &~$Q_3$ \\
\hline
$K$	  & rectangle de sommets~$\{a_1, a_2, a_3, a_4\}$ de côtés parallèles aux axes\\
$\Sigma$ &~$\left\{p(a_i), \frac{\partial p}{\partial x}(a_i), \frac{\partial p}{\partial y}(a_i),
	\frac{\partial^2 p}{\partial x\partial y}(a_i), i=1,\ldots, 4\right\}$\\
$P$   &~$P_3$ \\
Régularité &~$C^1$\\
\hline
\end{tabular}
\caption{Élément bidimensionnel rectangulaire d'Hermite~$Q_3$}\label{tab:ElemH:bibi}
\end{table}
\end{itemize}

\medskip
\section{Traitement de plusieurs champs}\label{Sec-interf}
Dans ce qui précède, le lecteur aura noté que l'on interpole un seul
champ, en imposant ou non certaines régularités (dérivées partielles).

\medskip
Une question naturelle consiste à se demander comment traiter les
problèmes ayant plusieurs champs inconnus (cela à déjà été abordé,
et certaines stratégies on déjà été présentées: formulation mixte (Brezzi),\index[aut]{Brezzi (Franco), 1945-, Italien}
utilisation de multiplicateurs de Lagrange).\index[aut]{Lagrange (Joseph Louis, comte de -), 1736-1813, Italien}\index{multiplicateurs de Lagrange}

On pourrait imaginer, si ces champs sont <<~dissociés~>> (sans lien les uns avec les
autres), de modéliser chaque champ séparément, i.e. de traiter un
problème par champ (avec pour chaque champ un choix de maillage et
d'élément qui lui est propre).

En fait, les problèmes à plusieurs champs ne concernent généralement
pas des champs indépendants.
Lorsque l'on a plusieurs champs interdépendants, alors on dispose de relations
entre ces champs, qui doivent elles-aussi être satisfaites.

\medskip
Nous avons exposé au chapitre précédent pourquoi la mécanique reste un cas
compliqué. Cela provient de ce que les champs inconnus sont les déplacements,
déformations et contraintes.
De plus, le chapitre précédent a permis une illustration du choix d'un modèle,
même lorsque l'on ne recourt qu'à une théorie à un champ (déplacements).

\medskip
Nous ne construirons pas ici un élément à plusieurs champs, mais nous
allons donner une motivation pour le faire: celui du calcul des contraintes à
l'interface entre deux matériaux différents que nous supposerons parfaitement
collés.

Considérons donc le problème décrit à la figure~\ref{interf}.
\begin{figure}[ht]
\centering
\includegraphics[height=50mm]{interface.eps}
\caption{Interface et continuités}\label{interf}
\end{figure}
Deux domaines~$\Omega_1$ et~$\Omega_2$, consittués chacun de leur
propre loi de comportement, ont une interface commune~$\Gamma_I$.
On supposera que le champ de déplacement est continu le long de~$\Gamma_I$.
La continuité de la composante normale du déplacement à l'interface traduit le
fait qu'il n'y a pas décollement entre les deux domaines; celle de la composante
tangentielle qu'il n'y a pas glissement entre eux.

On peut donc dire qu'en tout point de~$\Gamma_I$ le déplacement est
continu, ce que l'on peut noter~$u_i^1=u_i^2$.

\medskip
L'état d'équilibre des forces doit lui-aussi être vérifié le long de l'interface.
Cela implique que les composantes normales des contraintes doivent être également
continues le long de cette interface, i.e. que la trace du tenseur des contraintes doit
être continue le long de l'interface.
Par contre, les autres composantes peuvent (et doivent selon les cas) être
discontinues.

\bigskip
Plusieurs stratégies sont envisageables:
\begin{description}
\item[\textcolorblue{Post-traitement:}]\index{post-traitement}

	Dans cette méthode, on effectue le calcul en déplacements, de manière classique.
	On obtient les contraintes de manière toute aussi classique, mais celles-ci
	n'ont évidemment pas les continuités et discontinuités souhaitées.

	On utilise une méthode de post-traitement qui va modifier le calcul des contraintes
	sur les éléments situés de part et d'autre de l'interface, par exemple
	en imposant la vérification des équations d'équilibre (voir par exemple
	la méthode de Reissner locale, qui applique la fonctionnelle de Reissner uniquement
	le long de l'interface).\index[aut]{Reissner (Max Erich, dit Eric), 1913-1996, Américain}
\item[\textcolorblue{Élément mixte:}]

	La fonctionnelle d'Hellinger-Reissner\index[aut]{Reissner (Max Erich, dit Eric), 1913-1996, Américain}\index[aut]{Hellinger (Ernst David), 1883-1950, Allemand}\index{fonctionnelle!d'Hellinger-Reissner}
	possède les champs de déplacement et de
	contrainte comme inconnues. Elle conduit à un système de type mixte
	(équation \eqref{Eq:SysMixte}) avec une matrice qui n'est plus définie-positive.

	Il s'en suit que ces deux champs sont continus, et notamment que toutes les
	composantes des contraintes le sont, ce qui ne satisfait pas les conditions
	d'équilibre.

	Si l'on souhaite utiliser ce type d'élément, il faudra par exemple, faire une
	condensation statique des composantes devant être discontinues, ou
	utiliser une méthode de post-traitement.
\item[\textcolorblue{Élément hybride:}]

	La fonctionnelle de Pian et Tong (mixte hybride)\index[aut]{Pian (Theodore H.H.), 1919-2009, Américain}\index[aut]{Tong (Pin), ? , Chinois}
	présentée précédemment
	a l'avantage de ne pas faire intervenir de dérivée. Elle conduit elle-aussi
	à un système de type mixte, mais la matrice de rigidité n'est même
	plus symétrique (dans une discrétisation <<~brutale~>>). On sait la retraiter.

	Toutes les composantes des contraintes sont là aussi continues, et il faudra appliquer les
	mêmes remèdes que ci-dessus.

	Notons qu'un avantage de cette formulation c'est qu'elle nécessite la matrice
	de souplesse~$[S]$ au lieu de la matrice de Hooke~$[H]$, ce qui permet de
	traiter le cas des matériaux incompressibles.\index{loi de comportement!Hooke}\index{loi de comportement!incompressible}\index[aut]{Hooke (Robert), 1635-1703, Anglais}
\item[\textcolorblue{Multiplicateurs de Lagrange:}]\index{multiplicateurs de Lagrange}\index[aut]{Lagrange (Joseph Louis, comte de -), 1736-1813, Italien}
	
	D'une manière évidente, la continuité du champ de déplacements
	à l'interface~$\li$ entre deux éléments~$~^1$ et~$~^2$ peut être
	imposée par l'ajout à al fonctionnelle de la condition:
	\begin{equation} -\dint_{\li} \lambda_i(U_i^1-U_i^2)\ \dd\Gamma \end{equation}

	Cette condition est facile à écrire et facile à implémenter (mais on perd la
	définie-positivité de la matrice de rigidité).
	
	De plus, l'interprétation physique de ces multiplicateurs de Lagrange montre
	que ceux-ci sont égaux aux composantes normales des contraintes.
\end{description}
\medskip
Voilà quelques stratégies. D'autres peuvent exister, surtout si en plus on veut passer
sur des modèles poutre ou plaque.

Le but était de montrer que non seulement il est possible de développer de nombreux
éléments finis, mais que même à partir d'éléments existants, il est toujours
possible de construire une méthode numérique permettant d'obtenir les résultats
souhaités.

Les méthodes de post-traitement,\index{post-traitement} que nous n'aborderons pas dans ce document,
sont très riches et permettent de faire beaucoup de choses.
Elles ont en outre l'avantage d'être parfois plus faciles à implémenter dans des
codes industriels que de nouveaux éléments.

\medskip
\section{Validation pratique et indicateurs d'erreur}\label{Sec-ValidEF}
Les tests numériques des éléments et au delà des codes de calcul sont indispensables.
Non seulement ils permettent de vérifier la satisfaction de critères de convergence
et d'évaluer la précision des éléments finis développés, ce qui peut être
réalisé par une analyse mathématique, mais ils permettent également de s'assurer
de la bonne programmation.
\medskip
Plusieurs types de tests peuvent et doivent être faits, sur plusieurs problèmes
types. Ces tests concernent aussi bien un seul élément, que plusieurs
(\textcolorblue{patch-test}),\index{patch-test} et même différents maillages.
\medskip
En mécanique, on distingue les cas listés dans le tableau~\ref{tab:Elem:test}.
\begin{table}[ht]\centering\footnotesize
\begin{tabular}{>{\raggedright\arraybackslash}p{25mm}|>{\raggedright\arraybackslash}p{25mm}|>{\raggedright\arraybackslash}p{35mm}|>{\raggedright\arraybackslash}p{35mm}}
\hline
Problème / solution de référence & Maillage & Vérification & Importance \\ \hline
Mouvement rigide et déformations constantes & 1 élément & base polynomiale complète / modes parasites & \multirow{2}{35mm}{convergence du modèle élément fini vers la solution théorique lorsque le nombre d'élément tend vers l'infini. Test particulièrement pour les non standard ou non conformes.} \\ \cline{1-3}
Mouvement rigide et déformations constantes & plusieurs éléments: patch-test cinématique\index{patch-test} ou mécanique & base complète, conformité, indépendance par rapport au maillage (vérification
de l'assemblage), absence de modes parasites & \\ \hline
Champ de déformations générales & différents maillages & précision et influence de la distorsion sur les déplacements et la contrante & qualité de l'élément par raport à d'autres éléments existants.\\
\hline
\end{tabular}\caption{Test de validation}\label{tab:Elem:test}
\end{table}

\medskip
\subsection{Modes rigides et parasites}
Le problème consiste à savoir si un élément fini, que l'on définira ici par sa matrice
$\MM{K}$, peut présenter l'état de déformation nulle ou d'énergie interne nulle (mode ou
mouvement de corps rigide).

\medskip
Une méthode consiste à déterminer le nombre de valeurs propres \textcolorred{nulles} de~$\MM{K}$.
Ce nombre doit être égal au nombre de modes rigides: soit 3 en deux dimensions (2 translations, 1 rotation),
6 en trois dimensions et 1 en axisymétrique. On notera~$m_r$ le nombre de modes rigides.
S'il y a plus de valeurs propres nulles que de modes rigides, alors c'est qu'il y a des
\textcolorblue{modes parasites} à énergie nulle.
Ces modes parasites doivent disparaître après assemblage de plusieurs éléments
afin d'éviter que la matrice de rigidité soit singulière (d'où le test sur plusieurs éléments).
Le schéma d'intégration choisi pour la définition de l'élément (par exemple intégration
complète, réduite ou sélective) peut influer sur les modes parasites.
C'est pourquoi, il n'est pas toujours aussi simple de déterminer mathématiquement
ce facteur.

\medskip
Dans ce cas, il est possible d'introduire un champ de déplacement représentant le
mouvement rigide.
Pour chaque mode rigide~$i$, le vecteur~$\VV{u}^i_n$ associé à la matrice~$\MM{K}$ doit
vérifier:
\begin{equation}\MM{K}\VV{u}^i_n=\VV{0}\end{equation}
Un mode rigide quelconque étant une combinaison linéaire des modes~$\VV{u}^i_n$,
on construit un problème éléments finis dans lequel on impose~$m_r$ valeurs du vecteur~$\VV{u}^i_n$
et on détermine numériquement les~$n-m_r$ composantes (non imposées) de~$\VV{u}^i_n$.
Celles-ci doivent être identiques aux valeurs théoriques associées au mode
rigide~$i$. Si ce n'est pas le cas, c'est qu'il existe des modes rigides.
\medskip
\subsection{Modes associés aux déformations constantes}
Pour converger correctement l'élément doit également représenter
exactement l'état de déformations ou contraintes constantes (ou plus
généralement la représentation <<~constante~>> de tous les termes de la
forme variationnelle).

Dans un premier temps, on calcule les efforts nodaux correspondant à une contrainte fixée.
Dans un second temps, on introduit les efforts nodaux comme condition aux limites dans le modèle
élément fini et on vérifie si l'on retrouve bien l'état de contrainte initialement choisi.

\medskip
\subsection{Patch-tests}\index{patch-test}
Le domaine choisi doit posséder au moins un nœud à l'intérieur du domaine.
On définit un champ de déplacement conduisant à un état de déformation
désiré (constant ou non), que l'on introduit comme condition aux limites dans le modèle élément fini.
On vérifie qu'au point intérieur, l'état de déformation obtenu est bien celui
désiré.

\medskip
\subsection{Test de précision d'un élément}
On confronte le modèle élément fini à un ou des cas tests représentatifs de ce pour
quoi l'élément à été développé (élasticité tridimensionnelle,
bidimensionnelle, problème de torsion, problème avec concentrations locales de
déformations ou de contraintes, prise en compte des frontières courbes...).

Sur les composantes d'<<~intérêt~>>, on regardera s'il y a bien convergence
du modèle et sa vitesse de convergence en fonction du nombre d'éléments,
de la distorsion de ceux-ci...

\medskip
La <<~mesure~>> de l'écart peut demander une <<~jauge~>> particulière.
C'est ce que l'on appelle un \textcolorblue{estimateur d'erreur}.
Nous n'avons abordé jusqu'à présent que la mesure de l'erreur due à la
MEF elle-même, mais chaque problème particulier peut demander un
estimateur particulier.
Pour la mécanique, les estimateurs sont souvent liés à la qualité des
contraintes ou à des estimateurs d'énergie.

\medskip
Un \textcolorblue{indicateur local d'erreur} pourra par exemple être basé
sur l'écart entre les contraintes aux nœuds et aux frontières après
extrapolation des points d'intégration de chaque élément. On rappelle
que certaines contraintes doivent être nulles sur les frontières libres.

On trouve par exemple l'écart sur les contraintes équivalentes (selon un
sens à définir en fonction du type de matériau: par exemple von Mises\index[aut]{Mises (Richard Edler, von -), 1883-1953, Autrichien}
pour un matériau isotrope, Hill,\index[aut]{Hill (Rodney), 1921-2011, Anglais}
Tsaï-Hill,\index[aut]{Tsaï (Stephen W), ?-, Américain}
Tsaï-Wu...\index[aut]{Wu (Edward Ming-Chi), 1938-2009, Américain}
pour les matériaux anisotropes, les mousses, les os, les composites...);
l'écart sur la contrainte moyenne...

On peut également utiliser la densité d'énergie interne de
déformation sur chaque élément, l'idéal étant que tous les
éléments contribuent de manière identique à l'estimation de
l'énergie interne totale.

\medskip
Un \textcolorblue{indicateur global d'erreur} pourra être par exemple
la valeur de l'énergie potentielle totale. Plus sa valeur sera petite, meilleur
sera le modèle.

\medskip
On peut également s'assurer que certaines équations d'équilibre sont vérifiées
à l'intérieur d'un élément ou le long d'une frontière entre éléments (par
exemple à l'interface entre deux domaines, un problème évoqué un peu avant
au paragraphe~\ref{Sec-interf})...


\ifVersionAvecExemplesSepares\else
 \input{./tex/ex2}% élts 1D
 \input{./tex/ex8}% déplacements imposés en multiplicateurs de Lagrange 1D
\fi
