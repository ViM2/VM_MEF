%
\newif\ifCeChapitreEstEtoile% par défaut vaut false
\newlength\largeurBandeauHAL
\setlength\largeurBandeauHAL{11mm}
\newlength\HauteurDesPhotos
\ifVersionDuDocEstVincent\setlength\HauteurDesPhotos{26mm}\else\setlength\HauteurDesPhotos{23mm}\fi
%
\definecolor{color1}{RGB}{150,0,0} % title and sections
\definecolor{color1}{RGB}{8,20,98} % box background and authors
%
% PACKAGE titletoc
%
\contentsmargin{0cm}
\titlecontents{part}[0pc]
  {\addvspace{15pt}\sffamily\bfseries}
  {}
  {}
  {}
\titlecontents{chapter}[1.2cm]
{\addvspace{10pt}\large\sffamily\bfseries}%\llap{\chaptername\ }
{\color{ocre!60}\contentslabel[\Large\thecontentslabel]{1.2cm}\color{ocre}}
{}
{\color{ocre!60}\normalsize\sffamily\bfseries\;\titlerule*[.5pc]{.}\;\thecontentspage}%

\titlecontents{section}[1.2cm]
  {\addvspace{3pt}\bfseries}
  {\contentslabel[\thecontentslabel]{1.2cm}}
  {}
  {\hfill\color{black}\thecontentspage}

\titlecontents{subsection}[1.2cm]
  {\addvspace{0pt}\small}
  {\contentslabel[\thecontentslabel]{1.2cm}}
  {}
  {\;\titlerule*[.5pc]{.}\;\thecontentspage}
% fin package titletoc
%--------------------------------------------------------------------------
%
% redéfinition de l'apparence de la page des parties
%
\newlength\ecart
\newlength\ecarttoto
\newlength\separab
\ifVersionDuDocEstPourHAL% (alors bandeau HAL)
   \setlength\ecart{1.2cm}
   \ifVersionDuDocEstVincent\addtolength\ecart{4pt}\fi
   \newcommand{\parttitle}{}
   \setlength\ecarttoto{.965\paperwidth}
   \setlength\separab{3cm}
   \makeatletter
   \def\@part[#1]#2{%
   \renewcommand{\parttitle}{#1}%
   \ifnum \c@secnumdepth >-2\relax%
      \refstepcounter{part}%
      \addcontentsline{toc}{part}{\texorpdfstring{%
      \setlength\fboxsep{2pt}%
      \noindent\protect\colorbox{ocre}{\protect\vphantom{Ép}\protect\makebox[\ecart-2\fboxsep-2\fboxrule]{\color{black!5}\bfseries\thepart}}\;\colorbox{black!5}{\protect\vphantom{Ép}\protect\makebox[\linewidth-4\fboxsep-4\fboxrule-\ecart]{\MakeUppercase{#1}}}}{#1}}%
   \else%
      \addcontentsline{toc}{part}{#1}%
   \fi%
   {\centering%
   \interlinepenalty \@M%
   \normalfont%
   \ifVersionDuDocEstVincent\hspace*{-23.3mm}\else\hspace*{-\separab}\fi%
   \markboth{}{}
%   \thispagestyle{empty}
   \addtolength\ecarttoto{-\fboxsep}\addtolength\ecarttoto{-\fboxsep}
   \addtolength\ecarttoto{-\separab}\addtolength\ecarttoto{-\separab}
   \addtolength\ecarttoto{-\largeurBandeauHAL}
  \begin{minipage}[c][\largeurBandeauHAL][c]{\largeurBandeauHAL} ~\end{minipage}
   \colorbox{ocre}{\begin{minipage}[c][\separab][c]{\separab}\color{white}\Huge\sffamily\bfseries\centering\thepart\end{minipage}}\;\;\colorbox{black!5}{\begin{minipage}[c][\separab][c]{\ecarttoto}\Huge\centering\sffamily\bfseries\MakeUppercase{#2}\end{minipage}}\;\;\colorbox{black!30}{\begin{minipage}[c][\separab][c]{\separab}\mbox{}\end{minipage}}}%
   \@endpart}%
   \makeatother
%
\else% doc pas pour HAL
   \setlength\ecart{1.2cm}
   \ifVersionDuDocEstVincent\addtolength\ecart{4pt}\fi
   \newcommand{\parttitle}{}
   \setlength\ecarttoto{.965\paperwidth}
   \setlength\separab{3cm}
   \makeatletter
   \def\@part[#1]#2{%
   \renewcommand{\parttitle}{#1}%
   \ifnum \c@secnumdepth >-2\relax%
      \refstepcounter{part}%
      \addcontentsline{toc}{part}{\texorpdfstring{%
      \setlength\fboxsep{2pt}%
      \noindent\protect\colorbox{ocre}{\protect\vphantom{Ép}\protect\makebox[\ecart-2\fboxsep-2\fboxrule]{\color{black!5}\bfseries\thepart}}\;\colorbox{black!5}{\protect\vphantom{Ép}\protect\makebox[\linewidth-4\fboxsep-4\fboxrule-\ecart]{\MakeUppercase{#1}}}}{#1}}%
   \else%
      \addcontentsline{toc}{part}{#1}%
   \fi%
   {\centering%
   \interlinepenalty \@M%
   \normalfont%
   \ifVersionDuDocEstVincent\hspace*{-20.0mm}\else\hspace*{-\separab}\fi%
   \markboth{}{}
%   \thispagestyle{empty}
   \addtolength\ecarttoto{-\fboxsep}\addtolength\ecarttoto{-\fboxsep}%
   \addtolength\ecarttoto{-\separab}\addtolength\ecarttoto{-\separab}%
   \colorbox{ocre}{\begin{minipage}[c][\separab][c]{\separab}\color{white}\Huge\sffamily\bfseries\centering\thepart\end{minipage}}\;\;\colorbox{black!5}{\begin{minipage}[c][\separab][c]{\ecarttoto}\Huge\centering\sffamily\bfseries\MakeUppercase{#2}\end{minipage}}\;\;\colorbox{black!30}{\begin{minipage}[c][\separab][c]{\separab}\mbox{}\end{minipage}}}%
   \@endpart}%
   \makeatother
\fi
%
%--------------------------------------------------------------------------
%
% ENVIRONEMENTS: théorème, histoire...
%
\definecolor{jaune}{RGB}{248,186,24}
\definecolor{ocre}{RGB}{209,32,39}
\newtheoremstyle{nonumm}
{2pt}     %Space above
{2pt}     %Space below
{\small}%Body font
{}         %Indent amount
{\bf}      %Theorem head font
{\ }       %Punctuation after theorem head
{0.25em}   %Space after theorem head
{\kern-13pt\color{ocre}\turnbox{90}{\kern7pt\llap{\large\sffamily\thmname{#1}}}\kern9pt}
%
\makeatletter
\newtheoremstyle{plain}
{1pt}     %Space above
{1pt}     %Space below
{\normalfont}%Body font
{}         %Indent amount
{\bfseries}      %Theorem head font
{\ }       %Punctuation after theorem head
{0.25em}   %Space after theorem head
{\small\sffamily\color{ocre}\thmname{#1}\thmnumber{\@ifnotempty{#1}{ }\@upn{#2}}%
\thmnote{\ {\the\thm@notefont\normalsize\bf\color{black}--- #3.}}}
%
\newtheoremstyle{vide}
{4pt}     %Space above
{4pt}     %Space below
{\normalfont}%Body font
{}         %Indent amount
{\sffamily}      %Theorem head font
{\ }       %Punctuation after theorem head
{0.25em}   %Space after theorem head
{\color{ocre}\the\thm@notefont\small\bfseries#3.}
%
% remarque
\newlength\parindentSTD
\setlength{\parindentSTD}{\parindent}
\newenvironment{remarque}[1][Remarque]{\par\vskip5pt\footnotesize\abovedisplayskip=3pt plus1pt minus 1pt\belowdisplayskip=3pt plus1pt minus 1pt\relax%
\begin{list}{}{%
\labelwidth=-5pt%
\labelsep=5pt%
\leftmargin=25pt%
\rightmargin=25pt}\item[\it#1\@addpunct{.}]\ignorespaces\setlength{\parindent}{\parindentSTD}}{\end{list}\vskip5pt}

% commentaire
\newenvironment{com}{\par\vskip5pt\footnotesize\abovedisplayskip=3pt plus1pt minus 1pt\belowdisplayskip=3pt plus1pt minus 1pt\relax%
\begin{list}{}{%
\labelwidth=-5pt%
\labelsep=5pt%
\leftmargin=25pt%
\rightmargin=25pt}\item\ignorespaces\setlength{\parindent}{\parindentSTD}}{\end{list}\vskip5pt}
%
% résumé
\ifVersionDuDocEstVincent\newcommand{\TexteDelAbstract}{\textbf{Notes}}\else\newcommand{\TexteDelAbstract}{Résumé}\fi
\newenvironment{abstract}[1][\TexteDelAbstract]{%
\par\vskip5pt\small%
\abovedisplayskip=3pt plus1pt minus 1pt%
\belowdisplayskip=3pt plus1pt minus 1pt\relax%
\begin{list}{}{%
\labelwidth=-5pt%
\labelsep=5pt%
\leftmargin=100pt%
\rightmargin=-25pt}\item[#1\ \@addpunct{---}]\ignorespaces\setlength{\parindent}{\parindentSTD}}{\end{list}\vskip5pt}

% marge
\newenvironment{marge}{\small%
\abovedisplayskip=3pt plus1pt minus 1pt%
\belowdisplayskip=3pt plus1pt minus 1pt\relax%
\begin{list}{}{%
\labelsep=5pt%
\leftmargin=25pt%
\rightmargin=25pt}\item[]\ignorespaces\setlength{\parindent}{\parindentSTD}}{\end{list}\vskip5pt}

% indentation arpès théorèmes
\def\@endtheorem{\endtrivlist}% NEW
\makeatother
%
\theoremstyle{plain}
\colorlet{not}{black!5}
\newmdtheoremenv[outerlinewidth=0pt,leftmargin=0pt,rightmargin=0pt,backgroundcolor=not,outerlinecolor=black!30,linewidth=0pt,outermargin=0pt,innertopmargin=5pt,innerbottommargin=5pt,innerleftmargin=5pt,innerrightmargin=5pt,skipbelow=.5\baselineskip,skipabove=.5\baselineskip,linecolor=not]{theoreme}{Théorème}
\newmdtheoremenv[outerlinewidth=0pt,leftmargin=0pt,rightmargin=0pt,backgroundcolor=not,outerlinecolor=black!30,linewidth=0pt,outermargin=0pt,innertopmargin=5pt,innerbottommargin=5pt,innerleftmargin=5pt,innerrightmargin=5pt,skipbelow=.5\baselineskip,skipabove=.5\baselineskip,linecolor=not]{lemme}{Lemme}
\colorlet{def}{ocre!5}
\newmdtheoremenv[outerlinewidth=0pt,leftmargin=0pt,rightmargin=0pt,backgroundcolor=def,outerlinecolor=ocre!30,linewidth=0pt,outermargin=0pt,innertopmargin=5pt,innerbottommargin=5pt,innerleftmargin=5pt,innerrightmargin=5pt,skipbelow=.5\baselineskip,skipabove=.5\baselineskip,linecolor=def]{definition}{Définition}

\theoremstyle{nonumm}
\colorlet{not}{black!5}
\ifVersionDuDocEstVincent
\newmdtheoremenv[outerlinewidth=1pt,leftmargin=0pt,rightmargin=0pt,backgroundcolor=not,outerlinecolor=black!30,linewidth=0pt,outermargin=0pt,innertopmargin=5pt,innerbottommargin=5pt,innerleftmargin=25pt,innerrightmargin=5pt,skipbelow=.5\baselineskip,skipabove=.5\baselineskip,linecolor=not]{histoire}{Un peu d'histoire}
\else
\newmdtheoremenv[outerlinewidth=1pt,leftmargin=0pt,rightmargin=0pt,backgroundcolor=not,outerlinecolor=black!30,linewidth=0pt,outermargin=0pt,innertopmargin=5pt,innerbottommargin=5pt,innerleftmargin=25pt,innerrightmargin=5pt,skipbelow=.5\baselineskip,skipabove=.5\baselineskip,linecolor=not]{histoire}{Histoire}
\fi
\theoremstyle{vide}
\newtheorem{vide}{}

\newmdenv[skipabove=5pt,%
          skipbelow=5pt,%
		  backgroundcolor=black!5,%
		  linecolor=black!5,%
		  innerleftmargin=5pt,%
		  innerrightmargin=5pt,%
		  innertopmargin=5pt,%
		  leftmargin=0cm,%
		  rightmargin=0cm,%
		  innerbottommargin=5pt]{tBox}
\newmdenv[linecolor=color1,%
          linewidth=0.75pt,%
		  innerleftmargin=5pt,%
		  leftmargin=0cm,%
		  rightmargin=0cm,%
		  innerrightmargin=5pt]{aBox}
% fin des environnements
%
%--------------------------------------------------------------------------
% Bidouillage des chapitres
%
\makeatletter
\def\@chapter[#1]#2{\ifnum \c@secnumdepth >\m@ne
                       \if@mainmatter
                         \refstepcounter{chapter}%
                         \typeout{\@chapapp\space\thechapter.}%
                         \addcontentsline{toc}{chapter}%
                                   {\protect\numberline{\thechapter}#1}%
                       \else
                         \addcontentsline{toc}{chapter}{#1}%
                       \fi
                    \else
                      \addcontentsline{toc}{chapter}{#1}%
                    \fi
                    \chaptermark{#1}%
                    \addtocontents{lof}{\protect\addvspace{10\p@}}%
                    \addtocontents{lot}{\protect\addvspace{10\p@}}%
                    \if@twocolumn
                      \@topnewpage[\@makechapterhead{#2}]%
                    \else
                      \@makechapterhead{#2}%
                      \@afterheading
                    \fi%
%ajout
   \CeChapitreEstEtoilefalse
}
\def\@schapter#1{\if@twocolumn
                   \@topnewpage[\@makeschapterhead{#1}]%
                 \else
                   \@makeschapterhead{#1}%
                   \@afterheading
                 \fi
   \ifVersionDuDocEstVincent\addcontentsline{toc}{chapter}{\color{ocre} #1}\fi
   \CeChapitreEstEtoiletrue
}
\makeatother
%--------------------------------------------------------------------------
%
% PACKAGE fancyhdr
%
% fancyhdr parameters
\newlength\debordement
\newlength\ecartb
\setlength\ecartb{3em}
\setlength\fboxsep{2pt}
\setlength\fboxrule{0pt}
\pagestyle{fancy}%
\renewcommand{\chaptermark}[1]{\markboth{\sffamily #1}{}}%
\renewcommand{\sectionmark}[1]{\markright{\sffamily\footnotesize\thesection\hspace{5pt}#1}{}}%
\fancyhf{}%
\ifVersionDuDocEstVincent
   \ifVersionDuDocEstPourHAL% (alors bandeau HAL)
%      \setlength\debordement{\paperwidth-3\ecartb+8.5mm-\largeurBandeauHAL}%
      \setlength\debordement{\paperwidth-3\ecartb-\largeurBandeauHAL+6.5mm}% larg boîte centre
      \fancyfoot[CO]{\vskip1em\hspace{-4mm}\makebox[0cm]{%
      \colorbox{black!5}{\makebox[\largeurBandeauHAL]{\sffamily\footnotesize\vphantom{Élp}~}}%
     \colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}%
      \colorbox{black!5}{\makebox[\debordement]{\footnotesize\sffamily{\ifCeChapitreEstEtoile\else\;\thechapter.\fi}\ \leftmark\hfill\vphantom{Élp} \MakeUppercase{\parttitle\;}}}%
      \colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries%
      \color{black!5}\vphantom{Élp}\thepart}}}}%
      \fancyfoot[CE]{\vskip1em\hspace{4mm}\makebox[0cm]{%
      \colorbox{black!5}{\makebox[\largeurBandeauHAL]{\sffamily\footnotesize\vphantom{Élp}~}}%
      \colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries%
      \color{black!5}\vphantom{Élp}\thepart}}%
      \colorbox{black!5}{\makebox[\debordement]{\footnotesize\vphantom{Élp} \MakeUppercase{\;\parttitle}\hfill\sffamily{\ifCeChapitreEstEtoile\else\rightmark\;\fi}}}%
     \colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}%
      }}%
   \else% Pour Vincent et pas pour HAL
      \setlength\debordement{\paperwidth-2\ecartb-4mm}% larg boîte centre
      \fancyfoot[CO]{\vskip1em\hspace{-4mm}\makebox[0cm]{%
     \colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}%
      \colorbox{black!5}{\makebox[\debordement]{\footnotesize%
      \sffamily{\ifCeChapitreEstEtoile\else\;\thechapter.\fi}\ \leftmark\hfill\vphantom{Élp} \MakeUppercase{\parttitle\;}}}%
      \colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries%
      \color{black!5}\vphantom{Élp}\thepart}}}}%
      \fancyfoot[CE]{\vskip1em\hspace{3mm}\makebox[0cm]{%
      \colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries%
      \color{black!5}\vphantom{Élp}\thepart}}%
      \colorbox{black!5}{\makebox[\debordement]{\footnotesize\vphantom{Élp} \MakeUppercase{\;\parttitle}\hfill\sffamily{\ifCeChapitreEstEtoile\else\rightmark\;\fi}}}%
     \colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}%
      }}%

%      \setlength\debordement{\paperwidth-3\ecartb+5.1mm}
% qui n'est plus un débordement, mais pourquoi créer une dimension de plus...
%      \fancyfoot[CO]{\vskip1em\makebox[0cm]{\colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}\;\colorbox{black!5}{\makebox[\debordement]{\footnotesize\sffamily{\ifCeChapitreEstEtoile\else\thechapter.\fi}\ \leftmark\hfill\vphantom{Élp} \MakeUppercase{\parttitle}}}\;\colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries\color{black!5}\vphantom{Élp}\thepart}}}}%
%      \fancyfoot[CE]{\vskip1em\makebox[0cm]{\colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries\color{black!5}\vphantom{Élp}\thepart}}\;\colorbox{black!5}{\makebox[\debordement]{\footnotesize\sffamily\vphantom{Élp}\MakeUppercase{\parttitle} \hfill\rightmark\mbox{}}}\;\colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}}\hspace*{10.1mm}}%
   \fi
\else% Version Mathias
   \ifVersionDuDocEstPourHAL% (alors bandeau HAL) A AJOUTER
      \setlength\debordement{86pt}%
      \fancyheadoffset{\debordement}%
      \fancyfootoffset{\debordement}%
      \fancyfoot[LO]{\vskip30pt\colorbox{black!5}{\makebox[\largeurBandeauHAL]{\sffamily\footnotesize\vphantom{Élp}}}\;\colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}\;\colorbox{black!5}{\makebox[\linewidth-12\fboxsep-2\ecartb-\largeurBandeauHAL]{\footnotesize\sffamily{\ifCeChapitreEstEtoile\else\thechapter.\fi}\ \leftmark\hfill\vphantom{Élp} \MakeUppercase{\parttitle}}}\;\colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries\color{black!5}\vphantom{Élp}\thepart}}}%
      \fancyfoot[RE]{\vskip30pt\colorbox{black!5}{\makebox[\largeurBandeauHAL]{\sffamily\footnotesize\vphantom{Élp}}}\;\colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries\color{black!5}\vphantom{Élp}\thepart}}\;\colorbox{black!5}{\makebox[\linewidth-12\fboxsep-2\ecartb-\largeurBandeauHAL]{\footnotesize\sffamily\vphantom{Élp}\MakeUppercase{\parttitle} \hfill\rightmark\mbox{}}}\;\colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}}%
   \else
      \setlength\debordement{86pt}
      \fancyheadoffset{\debordement}%
      \fancyfootoffset{\debordement}%
      \fancyfoot[LO]{\vskip30pt\colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}\;\colorbox{black!5}{\makebox[\linewidth-9\fboxsep-2\ecartb]{\footnotesize\sffamily{\ifCeChapitreEstEtoile\else\thechapter.\fi}\ \leftmark\hfill\vphantom{Élp} \MakeUppercase{\parttitle}}}\;\colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries\color{black!5}\vphantom{Élp}\thepart}}}%
      \fancyfoot[RE]{\vskip30pt\colorbox{ocre}{\makebox[\ecartb]{\footnotesize\sffamily\bfseries\color{black!5}\vphantom{Élp}\thepart}}\;\colorbox{black!5}{\makebox[\linewidth-9\fboxsep-2\ecartb]{\footnotesize\sffamily\vphantom{Élp}\MakeUppercase{\parttitle} \hfill\rightmark\mbox{}}}\;\colorbox{black!30}{\makebox[\ecartb]{\sffamily\footnotesize\vphantom{Élp}\thepage}}}%
   \fi
\fi
\renewcommand{\headrulewidth}{0pt}%
\addtolength{\headheight}{2.5pt}%
\renewcommand{\footrulewidth}{0pt}%
\fancypagestyle{plain}{%
\fancyhead{}%
\renewcommand{\headrulewidth}{0pt}}%
							
% enlève l'entête des pages de fin de chapitre si nombre de pages impair
\makeatletter
\renewcommand{\cleardoublepage}{%
\clearpage\ifodd\c@page\else
\hbox{}
\vspace*{\fill}
\thispagestyle{empty}
\newpage
\fi}
\makeatother
% fin package fancyhdr
%--------------------------------------------------------------------------
%
% INDEX
%
\makeatletter
\renewenvironment{theindex}
               {\if@twocolumn
                  \@restonecolfalse
                \else
                  \@restonecoltrue
                \fi
				\addtocounter{chapter}{1}
                \twocolumn[\@makechapterhead{\indexname}]%
				\phantomsection
				\addcontentsline{toc}{chapter}{\protect\numberline{\thechapter}\indexname}%
                \@mkboth{\indexname}{\indexname}%
                \thispagestyle{fancy}\parindent\z@
                \parskip\z@ \@plus .3\p@\relax
                \columnseprule \z@
                \columnsep 35\p@
                \let\item\@idxitem}
               {\if@restonecol\onecolumn\else\clearpage\fi}
\makeatother
%--------------------------------------------------------------------------
%
% MACROS maths
%
\providecommand{\numero}{n$^\text{o}$}
\newcommand{\Part}{\mathcal P}
\newcommand{\VMcom}[1]{\par{\footnotesize\noindent$\sharp$\par\noindent#1\par\noindent$\natural$}\par}
\newcommand{\NN}{\ensuremath{\mathbb N}}
\newcommand{\ZZ}{\ensuremath{\mathbb Z}}
\newcommand{\QQ}{\ensuremath{\mathbb Q}}
\newcommand{\RR}{\ensuremath{\mathbb R}}
\newcommand{\CC}{\ensuremath{\mathbb C}}
\newcommand{\HH}{\ensuremath{\mathbb H}}
\newcommand{\KK}{\ensuremath{\mathbb K}}
%
\providecommand{\cL}{\ensuremath{\mathcal{L}}\xspace}%
\providecommand{\mO}{\ensuremath{\mathbb{O}}\xspace}%
\newcommand{\fbar}{\overline{f}_{\Omega}}
\renewcommand{\d}{\text{d}}
%\newcommand{\Tbar}{\overline{f}_{\Gamma}}
\newcommand{\Tbar}{\overline{T}}
\newcommand{\fbari}{\overline{f}_{\Omega_i}}
\newcommand{\Tbari}{\overline{f}_{\Gamma_i}}
\newcommand{\Cbar}{\overline{C}}
\newcommand{\T}{f_{\Gamma}}
\newcommand{\Ubar}{\overline{U}}
\newcommand{\lu}{\Gamma_u}
\newcommand{\ls}{\Gamma_\sigma}
\newcommand{\li}{\Gamma_I}
\def\TR{{\scriptscriptstyle T}}
\newcommand{\Eq}[1]{Eq.(\ref{#1})}
\newcommand{\attention}{{\raisebox{2ex}{\manfnt\char126}}}

%\newcommand{\L}{\mathscr{L}}
\newcommand{\Lin}{\mathcal{L}}
\newcommand{\Vlin}{\mathcal{V}}
\newcommand{\Uvar}{\mathcal{U}}
\newcommand{\Vect}[1]{\mathrm{Vect}}    % A VERIFIER (chapitre EltsTmp)
\newcommand{\card}[1]{\mathrm{card}}    % A VERIFIER (chapitre EltsTmp)


%
\providecommand{\dint}{\displaystyle\int}
\providecommand{\dsum}{\displaystyle\sum}
\definecolor{gris}{gray}{0.5}
\definecolor{green50}{rgb}{0,0.50,0}

\newcommand{\ansys}{\textsc{Ansys}\xspace}
\newcommand{\castem}{\textsc{Cast3M}\xspace}
\newcommand{\aster}{\textsc{Code Aster}\xspace}
\newcommand{\freefem}{\textsc{FreeFem++}\xspace}
\newcommand{\abaqus}{\textsc{Abaqus}\xspace}
\newcommand{\pln}{}
\providecommand{\dd}{\text{d}}%

\renewcommand{\figurename}{\textsc{Fig.}}
%--------------------------------------------------------------------------
%
% Package HYPERREF
%
\ifVersionDuDocEstVincent
   \hypersetup{hidelinks,backref=true, pagebackref=true,hyperindex=true,colorlinks=true,breaklinks=true,urlcolor= blue,linkcolor=black,pageanchor=true,hyperindex =true,bookmarks=false,bookmarksopen=false,pdftitle={Méthode des Éléments Finis},pdfauthor={Vincent Manet}, pdfsubject={Aspects mathématiques et illustrations pour l'ingénieur}}
\else
   \hypersetup{hidelinks,backref=true, pagebackref=true,hyperindex=true,colorlinks=false,breaklinks=true,urlcolor= blue,bookmarks=true,bookmarksopen=false,pdftitle={Méthode des Éléments Finis},pdfauthor={Vincent Manet}, pdfsubject={Aspects mathématiques et illustrations pour l'ingénieur}}
\fi
%
%--------------------------------------------------------------------------
%
% Package CUTWIN
%
\newlength\LargeurDeLaBoite
\newlength\LargeurRestante
\newlength\HauteurDeLaBoite
\newlength\HauteurDUneLigne
\newcounter{NombreDeLignes}
%\newcounter{DeltaNombreDeLignes}
%\setcounter{DeltaNombreDeLignes}{0}
\newsavebox\MaBoiteAvecPhotos
%
\newcommand{\ImageADroite}[1]{%
\renewcommand\windowpagestuff{\flushright\vskip5pt\makebox{\usebox{\MaBoiteAvecPhotos}}}
\setlength{\HauteurDeLaBoite}{\ht\MaBoiteAvecPhotos}%
\settowidth{\LargeurDeLaBoite}{\usebox{\MaBoiteAvecPhotos}}%
\addtolength{\HauteurDeLaBoite}{4\baselineskip}%
\addtolength{\LargeurDeLaBoite}{1em}%
\setlength{\LargeurRestante}{\linewidth-\LargeurDeLaBoite}
\setlength{\HauteurDUneLigne}{\baselineskip}
\setcounter{NombreDeLignes}{1*\ratio{\HauteurDeLaBoite}{\HauteurDUneLigne}}
\addtocounter{NombreDeLignes}{1}
%\addtocounter{NombreDeLignes}{\arabic{DeltaNombreDeLignes}}
\opencutright
\begin{cutout}{0}{\the\LargeurRestante}{0pt}{\arabic{NombreDeLignes}}
#1
\end{cutout}
}
%
\newcommand{\ImageAGauche}[1]{%
\renewcommand\windowpagestuff{\flushleft\vskip5pt\framebox{\usebox{\MaBoiteAvecPhotos}}}
\setlength{\HauteurDeLaBoite}{\ht\MaBoiteAvecPhotos}%
\settowidth{\LargeurDeLaBoite}{\usebox{\MaBoiteAvecPhotos}}%
\addtolength{\HauteurDeLaBoite}{4\baselineskip}%
\addtolength{\LargeurDeLaBoite}{1em}%
\setlength{\LargeurRestante}{\linewidth-\LargeurDeLaBoite}
\setlength{\HauteurDUneLigne}{\baselineskip}
\setcounter{NombreDeLignes}{1*\ratio{\HauteurDeLaBoite}{\HauteurDUneLigne}}
\addtocounter{NombreDeLignes}{1}
%\addtocounter{NombreDeLignes}{\arabic{DeltaNombreDeLignes}}
\opencutleft
\begin{cutout}{0}{0pt}{\the\LargeurRestante}{\arabic{NombreDeLignes}}
\ifVersionDuDocEstVincent\else\renewcommand{\medskip}{\vspace{medskipamount}}\renewcommand{\bigskip}{\vspace{bigskipamount}}\fi
#1
\end{cutout}
\ifVersionDuDocEstVincent\else\renewcommand{\medskip}{}\renewcommand{\bigskip}{}\fi
% Normalement, pas besoin de coder comme ça, mais j'ai peur que la redifinition de medskip et bigskip "sorte" de l'environnement
}
%
%--------------------------------------------------------------------------
% Résultats ex4
%
\def\ROT#1{{\rotatebox{90}{#1}}}
\def\UNROT#1{{\rotatebox{-90}{#1}}}
\font\gnuplot=cmr10 at 10pt
\definecolor{grisi}{gray}{0.25}
\definecolor{grisii}{gray}{0.5}
\definecolor{grisiii}{gray}{0.75}
\definecolor{grisiv}{gray}{0.5}
\definecolor{grisv}{gray}{0.5}
\definecolor{gris}{gray}{0.5}
\newcommand{\black}{\color{black}}
\newcommand{\grisi}{\color{grisi}}%   Plane 82   ou nskin=1
\newcommand{\grisii}{\color{grisii}}%   Solid 46   ou nskin=2
\newcommand{\grisiii}{\color{grisiii}}% Shell 91   ou nskin=3
\newcommand{\grisiv}{\color{grisiv}}%   Plane 82/2 ou nskin=4
\newcommand{\grisv}{\color{grisv}}%    Local Reissner
\newcommand{\gris}{\color{gris}}
%
%--------------------------------------------------------------------------
%
% MACROS MATHEMATIQUES
%
\renewcommand{\le}{\leqslant}
\renewcommand{\ge}{\geqslant}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Isom}{Isom}
\DeclareMathOperator{\dive}{div}
\DeclareMathOperator{\gradb}{\mathbf{grad}}
\DeclareMathOperator{\rotb}{\mathbf{rot}}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\vectt}{vect}
\DeclareMathOperator{\trace}{tr}
%
\ifVersionDuDocEstVincent
   \makeatletter
   \newcommand\MM@star[1]{\begin{bmatrix}#1\end{bmatrix}}
   \newcommand\MM@nostar[1]{\left[#1\right]}
   \newcommand\MM{\@ifstar{\MM@star}{\MM@nostar}}
   \newcommand\MMT@star[1]{\begin{bmatrix}#1\end{bmatrix}^T}
   \newcommand\MMT@nostar[1]{\left[#1\right]^T}
   \newcommand\MMT{\@ifstar{\MMT@star}{\MMT@nostar}}
   \newcommand\MMI@star[1]{\begin{bmatrix}#1\end{bmatrix}^{-1}}
   \newcommand\MMI@nostar[1]{\left[#1\right]^{-1}}
   \newcommand\MMI{\@ifstar{\MMI@star}{\MMI@nostar}}
   \newcommand\MMIT@star[1]{\begin{bmatrix}#1\end{bmatrix}^{-T}}
   \newcommand\MMIT@nostar[1]{\left[#1\right]^{-T}}
   \newcommand\MMIT{\@ifstar{\MMIT@star}{\MMIT@nostar}}
   \newcommand\VV@star[1]{\begin{Bmatrix}#1\end{Bmatrix}}
   \newcommand\VV@nostar[1]{\left\{#1\right\}}
   \newcommand\VV{\@ifstar{\VV@star}{\VV@nostar}}
   \makeatother
   \providecommand{\MMIT}[1]{\left[ #1\right]^{-T}}% Matrix []^{-T}
   \providecommand{\LL}[1]{\langle #1\rangle}%   Angle bracket <>
   \providecommand{\LLL}[1]{\langle #1\rangle}%   Angle bracket <>
   \newcommand{\fig}[1]{figure~\ref{#1}}
   \newcommand{\vect}[1]{\overrightarrow{#1}}%
   \providecommand{\LLP}[1]{\langle #1\rangle}%   Angle bracket <>
\else
   \DeclareSymbolFont{mymathvariables}{T1}{ptm}{m}{n}
   \DeclareSymbolFontAlphabet{\mathnormal}{mymathvariables}
   \DeclareMathSymbol{A}{\mathalpha}{mymathvariables}{`A}
   \DeclareMathSymbol{B}{\mathalpha}{mymathvariables}{`B}
   \DeclareMathSymbol{C}{\mathalpha}{mymathvariables}{`C}
   \DeclareMathSymbol{D}{\mathalpha}{mymathvariables}{`D}
   \DeclareMathSymbol{E}{\mathalpha}{mymathvariables}{`E}
   \DeclareMathSymbol{F}{\mathalpha}{mymathvariables}{`F}
   \DeclareMathSymbol{G}{\mathalpha}{mymathvariables}{`G}
   \DeclareMathSymbol{H}{\mathalpha}{mymathvariables}{`H}
   \DeclareMathSymbol{I}{\mathalpha}{mymathvariables}{`I}
   \DeclareMathSymbol{J}{\mathalpha}{mymathvariables}{`J}
   \DeclareMathSymbol{K}{\mathalpha}{mymathvariables}{`K}
   \DeclareMathSymbol{L}{\mathalpha}{mymathvariables}{`L}
   \DeclareMathSymbol{M}{\mathalpha}{mymathvariables}{`M}
   \DeclareMathSymbol{N}{\mathalpha}{mymathvariables}{`N}
   \DeclareMathSymbol{O}{\mathalpha}{mymathvariables}{`O}
   \DeclareMathSymbol{P}{\mathalpha}{mymathvariables}{`P}
   \DeclareMathSymbol{Q}{\mathalpha}{mymathvariables}{`Q}
   \DeclareMathSymbol{R}{\mathalpha}{mymathvariables}{`R}
   \DeclareMathSymbol{S}{\mathalpha}{mymathvariables}{`S}
   \DeclareMathSymbol{T}{\mathalpha}{mymathvariables}{`T}
   \DeclareMathSymbol{U}{\mathalpha}{mymathvariables}{`U}
   \DeclareMathSymbol{V}{\mathalpha}{mymathvariables}{`V}
   \DeclareMathSymbol{W}{\mathalpha}{mymathvariables}{`W}
   \DeclareMathSymbol{X}{\mathalpha}{mymathvariables}{`X}
   \DeclareMathSymbol{Y}{\mathalpha}{mymathvariables}{`Y}
   \DeclareMathSymbol{Z}{\mathalpha}{mymathvariables}{`Z}
   \makeatletter
   \newcommand\MM@star[1]{\begin{bmatrix}#1\end{bmatrix}}
   \newcommand\MM@nostar[1]{\mathbf{#1}}
   \newcommand\MM{\@ifstar{\MM@star}{\MM@nostar}}
   \newcommand\MMT@star[1]{{}^T\begin{bmatrix}#1\end{bmatrix}}
   \newcommand\MMT@nostar[1]{{}^\mathrm{T}\mathbf{#1}}
   \newcommand\MMT{\@ifstar{\MMT@star}{\MMT@nostar}}
   \newcommand\MMI@star[1]{\begin{bmatrix}#1\end{bmatrix}^{-1}}
   \newcommand\MMI@nostar[1]{\mathbf{#1}^{-1}}
   \newcommand\MMI{\@ifstar{\MMI@star}{\MMI@nostar}}
   \newcommand\MMIT@star[1]{{}^T\begin{bmatrix}#1\end{bmatrix}^{-1}}
   \newcommand\MMIT@nostar[1]{{}^\mathrm{T}\mathbf{#1}^{-1}}
   \newcommand\MMIT{\@ifstar{\MMIT@star}{\MMIT@nostar}}
   \newcommand\VV@star[1]{\begin{Bmatrix}#1\end{Bmatrix}}
   \newcommand\VV@nostar[1]{\mathbf{#1}}
   \newcommand\VV{\@ifstar{\VV@star}{\VV@nostar}}
   \makeatother
   \providecommand{\LL}[1]{{}^\mathrm{T}\mathbf{#1}}%   Angle bracket <>
   \providecommand{\LLL}[1]{{}^T\left( #1\right)}%   Angle bracket <>
   \newcommand{\vect}{\mathbf}%
   \newcommand{\fig}[1]{figure~\ref{#1}}
   \providecommand{\LLP}[1]{\left(#1\right)}%
\fi
%
\newcommand{\intoo}[2]{\mathopen{]}#1\,;#2\mathclose{[}}
\newcommand{\intff}[2]{\mathopen{[}#1\,;#2\mathclose{]}}
\newcommand{\intof}[2]{\mathopen{]}#1\,;#2\mathclose{]}}
\newcommand{\intfo}[2]{\mathopen{[}#1\,;#2\mathclose{[}}
\newcommand{\intervalle}[2]{\mathopen{(}#1\,;#2\mathclose{)}}

%--------------------------------------------------------------------------
% COLORATION DU TEXTE
%
\ifVersionDuDocEstVincent
   \newcommand{\textcolorblack}[1]{\textcolor{black}{#1}}
   \newcommand{\textcolorgreen}[1]{\textcolor{green50}{#1}}
   \newcommand{\textcolorred}[1]{\textcolor{red}{#1}}
   \newcommand{\textcolorblue}[1]{\textcolor{blue}{#1}}
   \newcommand{\textcolormagenta}[1]{\textcolor{magenta}{#1}}
   \newcommand{\textcolorgris}[1]{\textcolor{gris}{#1}}
   \newcommand{\colorblack}{\color{black}}
   \newcommand{\colorgreen}{\color{green50}}
   \newcommand{\colorred}{\color{red}}
   \newcommand{\colorblue}{\color{blue}}
   \newcommand{\colormagenta}{\color{magenta}}
   \newcommand{\colorgris}{\color{gris}}
   \renewcommand{\theFancyVerbLine}{\textcolor{green50}{\scriptsize\arabic{FancyVerbLine}}}
   \newcommand{\textbff}[1]{\textbf{#1}}
\else
   \newcommand{\textcolorblack}[1]{{\#1}}
   \newcommand{\textcolorgreen}[1]{#1}
   \newcommand{\textcolorred}[1]{#1}
   \newcommand{\textcolorblue}[1]{#1}
   \newcommand{\textcolormagenta}[1]{\emph{#1}}
   \newcommand{\textcolorgris}[1]{#1}
   \newcommand{\colorblack}{\relax\ifmmode\else\normalsize\rm\fi}
   \newcommand{\colorgreen}{\relax\ifmmode\else\em\fi}
   \newcommand{\colorred}{\relax\ifmmode\else\bf\fi}
   \newcommand{\colorblue}{\relax\ifmmode\else\em\fi}
   \newcommand{\colormagenta}{\relax\ifmmode\else\em\fi}
   \newcommand{\colorgris}{\relax\ifmmode\else\fi}
   \newcommand{\textbff}{}
   \renewcommand{\medskip}{}
   \renewcommand{\bigskip}{}
\fi
%
% Quelques compléments de mise en page
\newcommand{\medskipvm}{\ifVersionDuDocEstVincent

\medskip\fi}
\newcommand{\bigskipvm}{\ifVersionDuDocEstVincent

\bigskip\fi}

\ifVersionDuDocEstVincent\else
\makeatletter
\renewcommand\tableofcontents{%
    \if@twocolumn
      \@restonecoltrue\onecolumn
    \else
      \@restonecolfalse
    \fi
    \chapter*{\contentsname
    \@mkboth{\MakeUppercase\contentsname}{\MakeUppercase\contentsname}}%
	\phantomsection%
    \addcontentsline{toc}{chapter}{\protect\color{ocre} Table des matières}%
    \@starttoc{toc}%
    \if@restonecol\twocolumn\fi}
\makeatother
\fi
