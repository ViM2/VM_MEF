\newif\ifVersionDuDocEstVincent% par défaut vaut false, donc version livre (Mathias), sinon version cours (Vincent)
%\VersionDuDocEstVincenttrue% à commenter pour compilation de la version livre (Mathias)
\newif\ifVersionDuDocEstPourHAL% HAL (CEL...) ajoute un bandeau de largeur env 11mm...
\VersionDuDocEstPourHALtrue%
%
% Mise en page des figures dans l'ex4.tex du Ch Amelio.tex
\newif\ifVMSurLaMemePage% si la dernière fig et 1e 1er tableau sur la même page: true
%\VMSurLaMemePagetrue% vrai pour v2b cours
% il ne restera plus qu'à coder quelque chose du type (utiliser etoolbox au lieu de ifthen ou xifthen n'améliore pas les choses)
%\ifthenelse{\equal{\pageref{VMtiti}}{\pageref{VMtoto}}}{\VMSurLaMemePagetrue}{\VMSurLaMemePagefalse}
% Mais hyperef et french font que ce n'est pas possible
%
\newif\ifAuteursDansGallerie% ne sert qu'en version cours
%
\ifVersionDuDocEstVincent
   \VMSurLaMemePagetrue
   \documentclass[11pt,pdflatex]{book}
   \AuteursDansGalleriefalse%
\else
   \VMSurLaMemePagefalse
   \documentclass[fleqn,11pt,pdflatex]{book}
\fi
%
% packages communs
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fancyhdr}
\usepackage{array,subfig,wrapfig}
\usepackage{graphicx,color,epstopdf,rotating}
\usepackage{amsmath,amsfonts,mathrsfs,amsthm,amstext,mathtools,bbm}
\usepackage{hyperref,multirow,multicol,xspace}
\usepackage{cutwin,fancyvrb,titletoc}
\usepackage{microtype}
\usepackage[framemethod=tikz]{mdframed}
\usepackage[frenchb]{babel}
\usepackage[babel]{csquotes}
\MakeAutoQuote{«}{»}
\frenchbsetup{IndentFirst=false}
\usepackage{url}
\usepackage{eso-pic}
\usepackage{enumitem}
\usepackage[numbered,level=-1]{bookmark}
\usepackage[xindy]{imakeidx}
\makeindex[program=texindy,columns=2,title=Index des concepts,options=-M mystyle.xdy]
\makeindex[program=texindy,columns=2,name=aut,title=Index des noms propres]
%texindy -L french aut.idx
%texindy -L french -M mystyle.xdy VM_MEF.idx
\hypersetup{hidelinks,backref=true, pagebackref=true,hyperindex=true,colorlinks=false,breaklinks=true,urlcolor= blue,bookmarks=true,bookmarksopen=false,pdftitle={Méthode des Éléments Finis},pdfauthor={Vincent Manet}, pdfsubject={Aspects mathématiques et illustrations pour l'ingénieur}}
%
\ifVersionDuDocEstVincent
   \usepackage{amssymb,bm}
   \usepackage[a4paper,top=15mm,left=2cm,right=16.5mm,bottom=22mm]{geometry}
   \usepackage[%
     sorting=none,%
     sortcites=true,  % classer les citations multiples
     autopunct=true,  % gérer automatiquement les ponctuations
     babel=hyphen,    % ajuster les césure pour chaque entrée
     hyperref=true,   % les liens hypertexte, c'est le Bien
     abbreviate=false,% pas d'abréviation
     backref=true,
     bibencoding=utf8,
     backend=biber]{biblatex}
   \pagestyle{fancy}
   \addbibresource{VM_MEF0.bib}\addbibresource{VM_MEF1.bib}\addbibresource{VM_MEF2.bib}
   \addbibresource{VM_MEF3.bib}\addbibresource{VM_MEFA.bib}
   \defbibheading{bibliography}[\bibname]{\section*{#1}}
%
\else
   \usepackage{times}
   \gdef\ttdefault{cmtt}%
   \usepackage[amsbb,compatiblegreek,subscriptcorrection,nofontinfo,mtpscr]{mtpro2}
   \usepackage[top=2.2cm,bottom=3cm,left=3cm,right=3cm,a4paper,headsep=35pt]{geometry}
   \setlist{nolistsep} 
   \pagestyle{fancy}
   \usepackage[%
    style=alphabetic,          % citations comme [Fa91] pour Faltings, 91
     style=numeric-comp,
     sorting=nyt,              % classement par nom, année, titre
     sortcites=true,           % classer les citations multiples
     autopunct=true,           % gérer automatiquement les ponctuations
     babel=hyphen,             % ajuster les césure pour chaque entrée
     hyperref=true,            % les liens hypertexte, c'est bien
     abbreviate=false,         % pas d'abréviation
     backref=true,
     backend=biber]{biblatex}  % pas de réfs. aux pages où l'entrée est citée
   \addbibresource{VM_MEF0.bib}\addbibresource{VM_MEF1.bib}\addbibresource{VM_MEF2.bib}
   \addbibresource{VM_MEF3.bib}\addbibresource{VM_MEFA.bib}
   \defbibheading{bibempty}{}  % voir ci-dessous
%   \renewcommand{\leq}{\leqslant}
%   \renewcommand{\geq}{\geqslant}
\fi
   
\graphicspath{{./photos/}{./eps/}}

\include{./tex/macros}% macros

\begin{document}
\nocite{*}
\title{La Méthode des éléments Finis. Vulgarisation des aspects mathématiques. Illustration des capacités de la méthode}
\author{Vincent Manet}

% Recto de la page de titre
\ifVersionDuDocEstVincent
   \thispagestyle{empty}\mbox{}%
   \AddToShipoutPicture*{\includegraphics{Front}}%
%
   \setlength{\abovedisplayskip}{6pt plus 2pt minus 1pt}
   \setlength{\belowdisplayskip}{\abovedisplayskip}
   ~\\[+15cm]\centerline{Version 3 du \today}
   \title
\else
   \thispagestyle{empty}\mbox{}%
   \AddToShipoutPicture*{\includegraphics{Front}}%
%
   \setlength{\abovedisplayskip}{6pt plus 2pt minus 1pt}
   \setlength{\belowdisplayskip}{\abovedisplayskip}
%   \setlength{\abovecaptionskip}{3pt}
%   \setlength{\belowcaptionskip}{0pt}
   \title
\fi
% Verso de la page de titre
\newpage\mbox{}\thispagestyle{empty}%
\vspace*{2cm}

\vfill\normalsize\selectfont
\noindent Vincent Manet --- 2013 (Ceci est la version \ifVersionDuDocEstVincent \textcolorblue{«cours»} \else \textcolorblue{«livre»} \fi de ce document)\\
Ce document est sous licence Creative Commons 3.0 France:
\begin{itemize}
\item paternité;
\item pas d'utilisation commerciale;
\item partage des conditions initiales à l'identique;
\end{itemize}
\url{http://creativecommons.org/licenses/by-nc-sa/3.0/deed.fr}\\[8pt]
\includegraphics[width=5cm]{IconTog.eps}




\chapter*{Introduction}
\ifVersionDuDocEstVincent\else\addcontentsline{toc}{chapter}{Introduction}\fi
\markboth{Introduction}{}

Dans ce (de moins en moins court) document, plutôt à destination d'ingénieurs mécaniciens  connaissant déjà la méthode des éléments finis, nous allons essayer de faire une présentation un peu plus théorique que ce qui leur est généralement proposé (et qui est quand même souvent de type «preuve par les mains», ce qui occulte trop de points).

Nous ne ferons appel qu'à des notions mathématiques de bases généralement déjà vues pour la plupart en taupe (ou en tout début de cycle d'ingénieur)... bien que des compléments que l'on peut qualifier d'élémentaires nous aient été demandés et aient été inclus.

Nous espérons, grâce à cette présentation théorique montrer toute la souplesse et la puissance de la méthode, afin de permettre au lecteur d'envisager d'autres simulations que celles qu'il a pu déjà réaliser par le passé.

\medskip
Pourquoi un ingénieur pratiquant déjà les éléments finis devrait-il s'intéresser plus en profondeur aux mathématiques derrière la méthode ?

Tout d'abord parce que c'est beau et intéressant: deux raisons parfaitement licites et suffisantes. Mais surtout parce que le monde change! On souhaite des modélisations toujours plus proches du réel, toujours plus détaillées, toujours plus complexes, toujours plus couplées... Par ailleurs un constat s'impose: si la physique d'hier était essentiellement celle du continu, celle d'aujourd'hui est le règne du discontinu. Ainsi, connaître l'intégrale de Riemann et savoir intégrer par parties étaient autrefois des outils suffisants, alors qu'aujourd'hui il faut en passer par les dérivées au sens des distributions, les espaces de Sobolev, l'intégrale de Lebesgue...

Rester sur les outils d'hier c'est se condamner à résoudre les problèmes d'hier! C'est pourquoi ce document a vu le jour, pour essayer de présenter et d'expliquer «simplement» (nous l'espérons) les mathématiques derrière la méthode, mais sans demander au lecteur de se transformer en mathématicien.


\bigskip
\section*{But du document}
\markboth{But du document}{}
\addcontentsline{toc}{section}{But du document}

Le but initial était de \emph{présenter brièvement la théorie mathématique} derrière les éléments finis afin que les ingénieurs utilisant cette méthode puisse en envisager toutes les applications, ainsi que de \emph{couvrir les aspects qui}, selon nous, \emph{devraient être connus de tout ingénieur mécanicien impliqué ou intéressé par le calcul numérique}.

Toutefois, il s'envisage comme \textcolorblue{support de référence à plusieurs cours}, cours qui ne portent pas sur tous les aspects traités dans ce document, et pendant lesquels les aspects pratiques sont plus développés (avec mise en situation sur machine).

\medskip
Même si nous avons voulu rester le plus succinct possible, l'introduction de notions de proche en proche à conduit à un document qui fait aujourd'hui une certaine taille (par exemple, nous avons besoins des espaces de Sobolev, mais comment les introduire sans parler des espaces de Lebesgue, mais comment les introduire sans parler...).

Aussi le document a-t-il finalement été découpé en plusieurs parties: 
un survol des notions mathématiques, puis le traitement du problème continu constituent l'ossature théorique nécessaire à assoir la méthode des éléments finis sur un socle solide. La discrétisation par éléments finis à proprement parler n'est aborder qu'ensuite, et d'ailleurs un seul chapitre suffirait à en faire le tour... sauf à entrer plus dans le détail concernant «ce qui fâche»: homogénéisation, non linéarité, dynamique, ce qui est fait dans des chapitres séparés.

\medskip
Enfin, d'autres méthodes sont abordées car également très employées aujourd'hui. Aussi est-il indispensable selon nous d'en avoir entendu parlé et d'en connaître les principales notions (BEM, FEEC...).

\medskip
En annexes, se trouve un petit fourre-tout comprenant des choses censées être maîtrisées depuis la taupe (mais qui parfois nous sont demandées) et les compléments qui alourdiraient encore les propos précédents.

\medskip
Certaines notions (essentiellement de topologie) ne sont pas présentées dans ce document.
Il nous a semblé que le lecteur devait avoir quelques souvenirs de ce qu'est un ouvert, un fermé, l'adhérence, la densité...
Par ailleurs, leur nom peut être suffisamment évocateur pour se passer d'une définition formelle dans le contexte de ce document.

\bigskip
Attention, \textcolorred{ce document n'est pas un document de mathématiques}, il ne contient d'ailleurs aucune preuve.
C'est, dans ces deux premières parties, un \textcolorblue{document de vulgarisation} de notions mathématiques nécessaires à une bonne compréhension de la méthode des éléments finis.

%\medskip
Nous avons voulu réaliser un survol des notions importantes, mais malgré tout, afin de ne pas être parfois trop laconique, nous avons un peu débordé. \ifVersionDuDocEstVincent\textcolorgris{Dans ce cas, les passages considérés comme moins importants ont été mis en gris.}\fi

\medskip
\ifVersionDuDocEstVincent
D'ailleurs un certain «code couleur» sera plus ou moins respecté dans ce document. En \textcolorblue{bleu} ou en \textcolorred{rouge}, les termes ou points importants, en \textcolorgris{gris, les choses moins importantes} dont la lecture peut être oubliée et enfin en \textcolorgreen{vert, des remarques «de bon sens»} sur ce qui est exposé.
\fi

\medskip
En fin de document, un petit index des noms propres permettra au lecteur de replacer les divers développements mentionnés dans l'histoire...
Il se peut qu'il subsistent quelques erreurs, notamment au niveau des nationalités mentionnées, car il n'est pas toujours aisé de déterminer rapidement cette information (et nous ne connaissons pas toutes les biographies des personnes citées).

\medskip
\emph{Ce document a été réalisé très rapidement, et de manière extrêmement hachée. Il comporte forcément encore beaucoup de fautes: merci de m'en faire part.}




\bigskip
\section*{Démarche de l'ingénieur numéricien}
\markboth{Preface}{Démarche de l'ingénieur numéricien}
\addcontentsline{toc}{section}{Démarche de l'ingénieur numéricien}

En préambule à ce document, nous tenions à synthétiser \textcolorblue{la démarche complète de l'ingénieur numéricien}:
\begin{itemize}
   \item Modélisation / mise en équations -- Construction du problème continu (système d'équations aux dérivées partielles).
   \item Analyse mathématique du problème posé -- Existence, unicité, propriétés des solutions.
   \item Conception d'une méthode numérique -- Construction d'un problème discrétisé.
   \item Analyse numérique -- Questions de stabilité, convergence, précision.
   \item Algorithmique -- Choix de méthodes de résolution en dimension finie.
   \item Mise en œuvre sur ordinateur -- Programmation.
   \item Pre et Post Traitement (maillages / visualisation) -- Interpolation, extrapolation, outils de la CAO.
\end{itemize}

\medskip
Tous ces points ne seront évidemment pas abordés dans ce document!
\vfill
\noindent
\textcolorred{\textbf{Remerciements:}}

Nous n'avions pas prévu de réaliser une deuxième version aussi rapidement.
Celle-ci existe suite aux sollicitations de Mathias Legrand\index[aut]{Legrand (Mathias), ?- , Français}. C'est lui  qui a développé les macros nécessaires à l'amélioration très très nette de la qualité typographique (environnements pour les notes historiques, les théorèmes, lemmes...). Nous le remercions également pour sa relecture avisée.

C'est également pourquoi coexistent aujourd'hui deux versions (mais issues du même code source): l'une que nous appelons «version cours» (plus en accord avec ce que nous proposons en cours), et l'autre «version livre», plus proche d'un ouvrage.


\colorblack
\cleardoublepage
\tableofcontents
%\markboth{Table des matières}{}


 \part{Survol mathématique}
 \include{./tex/espaces}
 \include{./tex/Operat}
 \include{./tex/continu}
 \include{./tex/Lp}
 \include{./tex/Sobolev}
 \include{./tex/Resume1}

 \part{Problème continu}
 \include{./tex/phy-edp}
 \include{./tex/FFaible}
 \include{./tex/phy-ffble}
 \include{./tex/ex1}

 \part{Éléments finis}
 \include{./tex/MEFintro}
 \include{./tex/MEF}
 \include{./tex/model}
 \include{./tex/Elts}
 \include{./tex/Amelio}
 \include{./tex/Mesh}% v3
 \include{./tex/Homog}
 \include{./tex/temps}% ajouter dynamique rapide ?
 \include{./tex/ondes}% ajouter propagation des modes et interaction fluide/structure ?
 \include{./tex/non-lin}
 \include{./tex/rupture}
 \include{./tex/stocha}%v3
 \include{./tex/xfem}
 \include{./tex/singul}
 \include{./tex/ccl}

 \appendix
 \part{Annexes}
 \include{./tex/interp}
 \include{./tex/intnum}
 \include{./tex/ed}
 \include{./tex/new-raph}
 \include{./tex/schemanum}


\ifVersionDuDocEstVincent
   \chapter*{Bibliographie}\markboth{Bibliographie}{}
   \phantomsection

 Le présent document est essentiellement une composition faite à partir de textes trouvés sur le net, qui ont été «mis bout à bout» afin de réduire l'effort  de rédaction (le document ayant été réalisé à ressources minimales).

 Les principales  ressources bibliographiques utilisées pour la rédaction de ce document  sont listées ci-dessous et peuvent donc aisément être trouvées par le lecteur désireux d'approfondir certains thèmes (Google est ton ami).

 De nombreux ouvrages existent sur le sujet. Nous ne les avons volontairement pas  mentionnés. S'il vous faut des livres ou des thèses sur le sujet, mon bureau est  ouvert...

 Dans tout le document, nous nous sommes servi intensivement de Wikipédia.
 
   \printbibliography[keyword=0,title={Références générales}]
   \ifAuteursDansGallerie\index[aut]{Joly (Patrick), ?- , Français}\fi

   \printbibliography[keyword=1,title={Références de la partie 1}]
   \ifAuteursDansGallerie\index[aut]{Schwartz (Laurent), 1915-2002, Français}\index[aut]{Kato (Tosio), 1917-1999, Japonais}\index[aut]{Popier (Alexandre), ?-, Français}\index[aut]{Li (Daniel), ?-, Français}\index[aut]{Blayo (Éric), ?-, Français}\index[aut]{Allaire (Grégoire), ?-, Français}\index[aut]{Dahan-Dalmedico (Amy), ?-, Française}\index[aut]{Peiffer (Jeanne), ?-, Française}\index[aut]{Jacod (Jean), ?- , Français}\index[aut]{Hauchecorne (Bertrand), 1950-, Français}\fi

   \printbibliography[keyword=2,title={Références de la partie 2}]
   \ifAuteursDansGallerie\index[aut]{Scheid (Jean-François), ?- , Français}\index[aut]{Washizu (Kyuichiro), 1921-1981, Japonais}\index[aut]{Maitre (Jean-François), ?-, Français}\fi

   \printbibliography[keyword=3,title={Références de la partie 3}]
   \ifAuteursDansGallerie\index[aut]{Blayo (Éric), ?-, Français}\index[aut]{Boyer (Franck), 1977-, Français}\index[aut]{Batoz (Jean-Louis), 1947-, Français}\index[aut]{Dhatt (Gouri), ?-, Français}\index[aut]{Pousin (Jérôme), ?-, Français}\index[aut]{Champaney (Laurent), 1968-, Français}\index[aut]{Panasenko (Grigory), ?-, Russe}\index[aut]{Naceur (Hakim), ?-, Français}\index[aut]{Basseville (Stéphanie), ?-, Française}\index[aut]{Chaussedent (Stéphane), ?-, Français}\index[aut]{Feng (Zhi-Qiang), 1963-, Français}\index[aut]{Tsotsis (Thomas K.), ?- , Américain}\index[aut]{Lee (Shaw M.), ?- , Américain}\index[aut]{Saad (Patricia), ?- , Française}\index[aut]{Rethore@Réthoré (Julien), ?- , Français}\index[aut]{Chevreuil (Mathilde), ?- , Française}\index[aut]{Bahlouli (Nadia), ?- , Française}\index[aut]{San Mart\'in (Jorge), ?- , Chilien}\index[aut]{Scheid (Jean-François), ?- , Français}\index[aut]{Takahashi (Takéo), ?- , Français}\index[aut]{Tucsnak (Marius), ?- , Français}\index[aut]{Chen (Shiyi), ?-, Chinois}\index[aut]{Doolen (Gary D.), ?-, Américain}\index[aut]{Eggert (Kenneth G.), ?-, Américain}\index[aut]{Combescure (Didier), 1970- , Français}\index[aut]{Dureisseix (David), ?- , Français}\index[aut]{Soize (Christian), 1948- , Français}\index[aut]{Ladevèze (Pierre), ?- , Français}\index[aut]{Berveiller (Marc), ?- , Français}\index[aut]{Krikorian (Raphaël), ?- , Français}\index[aut]{Ghanem (Roger G.), ?-, Libanais}\index[aut]{Spanos (Pol D.), ?-, Grec}\index[aut]{Frey (Pascal), ?- , Français},\index[aut]{Hecht (Frédéric), ?- , Français}\index[aut]{Heschung (Frédéric), ?- , Français}\index[aut]{Hetroy (Franck), ?- , Français}\index[aut]{Oudot (Steve Yann), ?-, Américain}\index[aut]{Lemaire (Christophe), ?-, Français}\index[aut]{Weill (Jean-Christophe), ?-, Français}\fi

   \printbibliography[keyword=A,title={Références des annexes}]
   \ifAuteursDansGallerie\index[aut]{Dysli (Michel), 1935-, Suisse}\index[aut]{Champaney (Laurent), 1968-, Français}\index[aut]{Blayo (Éric), ?-, Français}\index[aut]{Golub (Gene  Howard), 1932-2007, Américain}\index[aut]{van Loan (Charles F.), ?-, Américain}\fi

   \cleardoublepage
      \begingroup\small
        \printindex[aut]
        \printindex
   \endgroup

   \cleardoublepage
   \include{./tex/galerie}
%
\else % version livre
   \begingroup\small
     \printindex[aut]
     \printindex
   \endgroup
%   \nocite{*}% déjà en début de document
   \chapter{Références bibliographiques}
   \printbibliography[heading=bibempty]
\fi

\end{document}
